<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@600&display=swap');

    h2 {
        font-family: 'IBM Plex Sans';
        font-size: 24px;
        font-weight: 600;
        margin: 0;
        text-align: left;
    }

    p.description {
        padding: 0;
        margin: 0;
        font-size: 13px;
        line-height: 16px;
    }

    body {
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: 'Inter', sans-serif;
        padding: 16px;

        background-color: var(--figma-color-bg);
        color: var(--figma-color-text);

        user-select: none;
    }

    .layout-flex {
        display: flex;
    }

    .h-stack {
        flex-direction: row;
    }

    .v-stack {
        flex-direction: column;
        align-items: flex-start;
        row-gap: 12px;
    }

    div.wrapper {
        align-self: center;
        justify-content: space-between;
        width: 320px;
        height: 270px;
    }

    label {
        width: 100%;
        font-size: 12px;
    }

    input {
        padding: 12px 8px 12px 0;
        width: 100% !important;
        border: none;
        border-bottom: solid 1px var(--figma-color-border);
        color: var(--figma-color-text);
        outline: none;
        border-radius: 4px;
        font-size: 14px;
    }

    input::placeholder {
        color: var(--figma-color-text-tertiary);
    }

    button {
        background-color: var(--figma-color-bg-brand);
        border: none;
        color: var(--figma-color-text-onbrand);
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 11px;
        cursor: pointer;
    }

    button:hover {
        background-color: var(--figma-color-bg-brand-hover);
    }

    button:active {
        background-color: var(--figma-color-bg-brand-secondary);
    }

    label {
        display: flex;
        flex-direction: column;
        row-gap: 4px;
    }

    .hide {
        display: none !important;
    }

    .loading {
        width: 100%;
        display: flex;
        flex-direction: row;
        animation: blink-text 1.9s linear infinite;
        color: var(--figma-color-text-component);
    }

    .text-danger {
        color: var(--figma-color-text-danger-tertiary);
    }

    .lib-img {
        width: 320px;
    }

    label {
        width: 100%;
        font-size: 12px;
    }

    input {
        padding: 12px 8px 12px 0;
        width: 100% !important;
        border: none;
        border-bottom: solid 1px var(--figma-color-border);
        color: var(--figma-color-text);
        outline: none;
        font-size: 11px;
        width: 100%;
        height: 32px;
        border-radius: 0;
    }

    input:focus {
        border-bottom-color: var(--figma-color-border-selected);
    }

    input::placeholder {
        color: var(--figma-color-text-tertiary);
    }

    @keyframes blink-text {
        0% {
            opacity: 0;
        }

        50% {
            opacity: 1;
        }

        100% {
            opacity: 0;
        }
    }
</style>

<div class="wrapper layout-flex v-stack">
    <div class="layout-flex v-stack">
        <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_10_41)">
                <rect width="48" height="48" rx="12" fill="#F4F5F6" />
                <path
                    d="M22.8502 54.5199V41.3262H33.2241V40.855C30.0412 38.8524 27.5165 36.2215 25.65 32.9623C23.7835 29.7031 22.8502 25.7764 22.8502 21.1822C22.8502 17.118 23.5772 13.3877 25.0311 9.99107C26.485 6.59447 28.548 3.65925 31.22 1.18542C33.8921 -1.2884 37.0455 -3.20267 40.6803 -4.55739C44.3151 -5.93174 48.3134 -6.61891 52.6751 -6.61891C57.0368 -6.61891 61.0351 -5.93174 64.6699 -4.55739C68.3047 -3.20267 71.4581 -1.2884 74.1301 1.18542C76.8022 3.65925 78.8652 6.59447 80.3191 9.99107C81.773 13.3877 82.5 17.118 82.5 21.1822C82.5 25.7764 81.5667 29.7031 79.7002 32.9623C77.8337 36.2215 75.309 38.8524 72.1261 40.855V41.3262H82.5V54.5199H56.919V38.0278C58.7265 37.321 60.2885 36.2215 61.6049 34.7293C62.9409 33.2372 63.9626 31.4702 64.6699 29.4283C65.3968 27.3864 65.7603 25.1874 65.7603 22.8314C65.7603 19.8864 65.2102 17.2849 64.1099 15.0271C63.0097 12.7496 61.4772 10.9727 59.5124 9.69656C57.5477 8.40075 55.2686 7.75284 52.6751 7.75284C50.7693 7.75284 49.0108 8.12588 47.3997 8.87196C45.8083 9.5984 44.4232 10.639 43.2443 11.9937C42.0851 13.3288 41.1813 14.9191 40.533 16.7646C39.9042 18.5906 39.5899 20.6128 39.5899 22.8314C39.5899 25.1874 39.9435 27.3864 40.6508 29.4283C41.3778 31.4702 42.3995 33.2372 43.7158 34.7293C45.0519 36.2215 46.6237 37.321 48.4312 38.0278V54.5199H22.8502Z"
                    fill="#22252B" />
                <path
                    d="M18 54.5199V41.3262H28.3739V40.855C25.191 38.8524 22.6663 36.2215 20.7998 32.9623C18.9333 29.7031 18 25.7764 18 21.1822C18 17.118 18.727 13.3877 20.1809 9.99107C21.6348 6.59447 23.6978 3.65925 26.3698 1.18542C29.0419 -1.2884 32.1953 -3.20267 35.8301 -4.55739C39.4649 -5.93174 43.4631 -6.61891 47.8249 -6.61891C52.1866 -6.61891 56.1849 -5.93174 59.8197 -4.55739C63.4544 -3.20267 66.6079 -1.2884 69.2799 1.18542C71.952 3.65925 74.015 6.59447 75.4689 9.99107C76.9228 13.3877 77.6498 17.118 77.6498 21.1822C77.6498 25.7764 76.7165 29.7031 74.85 32.9623C72.9835 36.2215 70.4588 38.8524 67.2759 40.855V41.3262H77.6498V54.5199H52.0687V38.0278C53.8763 37.321 55.4383 36.2215 56.7547 34.7293C58.0907 33.2372 59.1124 31.4702 59.8197 29.4283C60.5466 27.3864 60.9101 25.1874 60.9101 22.8314C60.9101 19.8864 60.36 17.2849 59.2597 15.0271C58.1595 12.7496 56.627 10.9727 54.6622 9.69656C52.6975 8.40075 50.4183 7.75284 47.8249 7.75284C45.9191 7.75284 44.1606 8.12588 42.5495 8.87196C40.9581 9.5984 39.5729 10.639 38.3941 11.9937C37.2349 13.3288 36.3311 14.9191 35.6827 16.7646C35.054 18.5906 34.7397 20.6128 34.7397 22.8314C34.7397 25.1874 35.0933 27.3864 35.8006 29.4283C36.5276 31.4702 37.5492 33.2372 38.8656 34.7293C40.2017 36.2215 41.7735 37.321 43.581 38.0278V54.5199H18Z"
                    fill="#3B84F1" />
            </g>
            <defs>
                <clipPath id="clip0_10_41">
                    <rect width="48" height="48" rx="12" fill="white" />
                </clipPath>
            </defs>
        </svg>
        <h2>Omega DS Switcher</h2>
        <div id="onboarding" class="layout-flex v-stack hide">
            <p class="description hide">
                Чтобы плагин заработал — введите персональный токен. Его можно
                найти в руководстве Omega DS.
            </p>
            <input id="token" placeholder="Ваш персональный токен" />
        </div>

        <div id="content" class="layout-flex v-stack hide">
            <p class="description">
                Переключайте цветовые темы в&nbsp;макетах, собранных на&nbsp;Omega&nbsp;DS. Чтобы всё работало&nbsp;—
                убедитесь, что используете стили Omega DS.
            </p>
            <p class="description">
                Выберите компонент или фрейм и нажмите «Изменить тему»
            </p>
        </div>

    </div>
    <button class="hide" id="switch-theme">Изменить тему</button>
    <button class="hide" id="provide-token">Сохранить токен</button>

</div>

<script>
    onmessage = (event) => {
        if (event.data.pluginMessage.type === 'show-ui') {
            document.getElementById('content').classList.remove('hide')
        }

        if (event.data.pluginMessage.type === 'omega-needed') {
            document.getElementById('content').classList.add('hide')
            document.getElementById('switch-theme').classList.add('hide')
        }

        if (event.data.pluginMessage.type === 'stop-loading') {
            document.getElementById('content').classList.remove('hide')
            document.getElementById('switch-theme').classList.remove('hide')
            document.getElementById('loading').classList.add('hide')
        }

        if (event.data.pluginMessage.type === 'token-needed') {
            let onboarding = document.getElementById('onboarding')
            let provide_token_button = document.getElementById('provide-token')
            let switch_theme_button = document.getElementById('switch-theme')
            let loading = document.getElementById('loading')

            onboarding.classList.remove('hide')
            provide_token_button.classList.remove('hide')
            switch_theme_button.classList.add('hide')
            loading.classList.add('hide')
        }

        if (event.data.pluginMessage.type === 'loading') {
            let onboarding = document.getElementById('onboarding')
            let provide_token_button = document.getElementById('provide-token')
            let switch_theme_button = document.getElementById('switch-theme')
            let loading = document.getElementById('loading')

            onboarding.classList.add('hide')
            provide_token_button.classList.add('hide')
            switch_theme_button.classList.add('hide')
            loading.classList.remove('hide')
        }

    }

    document.getElementById('switch-theme').onclick = () => {
        parent.postMessage({ pluginMessage: { type: 'switch-theme' } }, '*')
    }

    document.getElementById('provide-token').onclick = () => {
        let token = document.getElementById('token').value.toString();
        console.log(token)
        parent.postMessage({ pluginMessage: { type: 'provide-token', token: token } }, '*')
    }
</script>